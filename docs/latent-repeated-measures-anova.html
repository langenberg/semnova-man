<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Latent repeated measures ANOVA | semnova: An R package for latent repeated measures ANOVA</title>
  <meta name="description" content="3 Latent repeated measures ANOVA | semnova: An R package for latent repeated measures ANOVA" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Latent repeated measures ANOVA | semnova: An R package for latent repeated measures ANOVA" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="3 Latent repeated measures ANOVA | semnova: An R package for latent repeated measures ANOVA" />
  <meta name="github-repo" content="langenberg/semnova-man" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Latent repeated measures ANOVA | semnova: An R package for latent repeated measures ANOVA" />
  
  <meta name="twitter:description" content="3 Latent repeated measures ANOVA | semnova: An R package for latent repeated measures ANOVA" />
  

<meta name="author" content="Benedikt Langenberg and Axel Mayer" />


<meta name="date" content="2021-01-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="example.html"/>
<link rel="next" href="traditional-anova.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">HOME</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li><a href="index.html#about-semnova">About <code>semnova</code></a></li>
<li><a href="index.html#citing-semnova">Citing <code>semnova</code></a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#changelog"><i class="fa fa-check"></i>Changelog</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>1</b> Installation</a><ul>
<li class="chapter" data-level="1.1" data-path="installation.html"><a href="installation.html#installation-via-devtools-recommended"><i class="fa fa-check"></i><b>1.1</b> Installation via <code>devtools</code> (recommended)</a></li>
<li class="chapter" data-level="1.2" data-path="installation.html"><a href="installation.html#installation-via-cran"><i class="fa fa-check"></i><b>1.2</b> Installation via <code>cran</code></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="example.html"><a href="example.html"><i class="fa fa-check"></i><b>2</b> Example</a><ul>
<li class="chapter" data-level="2.1" data-path="example.html"><a href="example.html#getting-the-data"><i class="fa fa-check"></i><b>2.1</b> Getting the Data</a></li>
<li class="chapter" data-level="2.2" data-path="example.html"><a href="example.html#introducing-the-data"><i class="fa fa-check"></i><b>2.2</b> Introducing the Data</a></li>
<li class="chapter" data-level="2.3" data-path="example.html"><a href="example.html#preparing-the-data"><i class="fa fa-check"></i><b>2.3</b> Preparing the Data</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="latent-repeated-measures-anova.html"><a href="latent-repeated-measures-anova.html"><i class="fa fa-check"></i><b>3</b> Latent repeated measures ANOVA</a><ul>
<li class="chapter" data-level="3.1" data-path="latent-repeated-measures-anova.html"><a href="latent-repeated-measures-anova.html#arguments"><i class="fa fa-check"></i><b>3.1</b> Arguments</a><ul>
<li><a href="latent-repeated-measures-anova.html#formula"><code>formula</code></a></li>
<li><a href="latent-repeated-measures-anova.html#idata"><code>idata</code></a></li>
<li><a href="latent-repeated-measures-anova.html#idesign"><code>idesign</code></a></li>
<li><a href="latent-repeated-measures-anova.html#mmodel"><code>mmodel</code></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="latent-repeated-measures-anova.html"><a href="latent-repeated-measures-anova.html#the-first-analysis"><i class="fa fa-check"></i><b>3.2</b> The first analysis</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="traditional-anova.html"><a href="traditional-anova.html"><i class="fa fa-check"></i><b>4</b> Traditional ANOVA</a></li>
<li class="chapter" data-level="5" data-path="under-construction-fit-measures.html"><a href="under-construction-fit-measures.html"><i class="fa fa-check"></i><b>5</b> [under construction] Fit Measures</a></li>
<li class="chapter" data-level="6" data-path="under-construction-interindividual-differences.html"><a href="under-construction-interindividual-differences.html"><i class="fa fa-check"></i><b>6</b> [under construction] Interindividual Differences</a></li>
<li class="chapter" data-level="7" data-path="under-construction-custom-contrasts.html"><a href="under-construction-custom-contrasts.html"><i class="fa fa-check"></i><b>7</b> [under construction] Custom Contrasts</a></li>
<li class="chapter" data-level="8" data-path="under-construction-between-subject-factors.html"><a href="under-construction-between-subject-factors.html"><i class="fa fa-check"></i><b>8</b> [under construction] Between-Subject Factors</a></li>
<li class="chapter" data-level="9" data-path="under-construction-covariance-structures.html"><a href="under-construction-covariance-structures.html"><i class="fa fa-check"></i><b>9</b> [under construction] Covariance Structures</a></li>
<li class="chapter" data-level="10" data-path="under-construction-visualization.html"><a href="under-construction-visualization.html"><i class="fa fa-check"></i><b>10</b> [under construction] Visualization</a></li>
<li class="chapter" data-level="11" data-path="outlook.html"><a href="outlook.html"><i class="fa fa-check"></i><b>11</b> Outlook</a><ul>
<li class="chapter" data-level="11.1" data-path="outlook.html"><a href="outlook.html#roadmap"><i class="fa fa-check"></i><b>11.1</b> Roadmap</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><code>semnova</code>: An R package for latent repeated measures ANOVA</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="latent-repeated-measures-anova" class="section level1">
<h1><span class="header-section-number">3</span> Latent repeated measures ANOVA</h1>
<div id="arguments" class="section level2">
<h2><span class="header-section-number">3.1</span> Arguments</h2>
<p>The input for <code>semnova</code> is very similar to the <code>car</code> package for analysis of variance <span class="citation">(Fox &amp; Weisberg, <a href="references.html#ref-Fox2019a">2019</a>)</span>. It takes the following arguments:</p>
<ul>
<li><code>formula</code>: A formula object.</li>
<li><code>idesign</code>: A design object describing the factorial design.</li>
<li><code>idata</code>: A table mapping the dependent variables to the experimental conditions.</li>
<li><code>data</code>: A dataset.</li>
<li><code>mmodel</code> (optional): A measurement model mapping the variables from the dataset to the variables in the formula object. If not given, the variables from the formula object will be used.</li>
</ul>
<div id="formula" class="section level3 unnumbered">
<h3><code>formula</code></h3>
<p>The formula object contains the names of the dependent variables (i.e., the combinations of the levels of the factors).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">formula &lt;-<span class="st"> </span><span class="kw">cbind</span>(NN, PN, NP, PP) <span class="op">~</span><span class="st"> </span><span class="dv">1</span></a></code></pre></div>
<p>NN, for instance, represents the condition Peer = negative and Human = negative.</p>
</div>
<div id="idata" class="section level3 unnumbered">
<h3><code>idata</code></h3>
<p>The idata object is a dataframe that has as many rows as variables in the formula object. The columns represent the experimental factors. The rows represent the possible combinations of the factor levels.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">idata &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">Peer =</span> <span class="kw">c</span>(<span class="st">&quot;negative&quot;</span>, <span class="st">&quot;positive&quot;</span>),</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">                     <span class="dt">Human =</span> <span class="kw">c</span>(<span class="st">&quot;negative&quot;</span>, <span class="st">&quot;positive&quot;</span>))</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">idata</a></code></pre></div>
<pre><code>##       Peer    Human
## 1 negative negative
## 2 positive negative
## 3 negative positive
## 4 positive positive</code></pre>
<p>The idata object maps the combinations of the factorial levels to the variables in the formula object.</p>
</div>
<div id="idesign" class="section level3 unnumbered">
<h3><code>idesign</code></h3>
<p>The design object is a formula object that represents the effects of interest. That is, when expanded, the formula contains the terms (i.e., the main and interaction effects) that the user is interested in. Currently, <code>semnova</code> can only model saturated models, that is, all possible terms are inlcuded. Subsets are currently not possible, but will this feature will be added in the future.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">idesign &lt;-<span class="st"> </span><span class="er">~</span>Peer<span class="op">*</span>Human</a></code></pre></div>
</div>
<div id="mmodel" class="section level3 unnumbered">
<h3><code>mmodel</code></h3>
<p>The measurement model is optional. If the dependent variables are measure via multiple indicators, the <code>create_mmodel()</code> can be used to map variables from the dataset to the variables from the formula object. By default, the effects-coding indentification method introduced by <span class="citation">Little et al. (<a href="references.html#ref-Little2006a">2006</a>)</span> is used. If you prefer the referent-indicator method, add the argument <code>lv_scaling = &quot;referent</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">library</span>(semnova)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">mmodel &lt;-<span class="st"> </span><span class="kw">create_mmodel</span>(</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">  <span class="dt">NN =</span> <span class="kw">c</span>(<span class="st">&quot;S1NN&quot;</span>, <span class="st">&quot;S2NN&quot;</span>),</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">  <span class="dt">PN =</span> <span class="kw">c</span>(<span class="st">&quot;S1PN&quot;</span>, <span class="st">&quot;S2PN&quot;</span>),</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">  <span class="dt">NP =</span> <span class="kw">c</span>(<span class="st">&quot;S1NP&quot;</span>, <span class="st">&quot;S2NP&quot;</span>),</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">  <span class="dt">PP =</span> <span class="kw">c</span>(<span class="st">&quot;S1PP&quot;</span>, <span class="st">&quot;S2PP&quot;</span>)</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">)</a></code></pre></div>
</div>
</div>
<div id="the-first-analysis" class="section level2">
<h2><span class="header-section-number">3.2</span> The first analysis</h2>
<p>The function <code>semnova()</code> performs the analysis and takes the aforementioned arguments:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">library</span>(semnova)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"></a>
<a class="sourceLine" id="cb11-3" data-line-number="3">fit &lt;-<span class="st"> </span><span class="kw">semnova</span>(</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">  <span class="dt">formula =</span> <span class="kw">cbind</span>(NN, PN, NP, PP) <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">  <span class="dt">data =</span> d_wide,</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">  <span class="dt">idata =</span> idata,</a>
<a class="sourceLine" id="cb11-7" data-line-number="7">  <span class="dt">idesign =</span> idesign,</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">  <span class="dt">mmodel =</span> mmodel</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">)</a></code></pre></div>
<p>Hypothesis tests of default main and interaction effects can be printed using the <code>summary()</code> function:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">summary</span>(fit)</a></code></pre></div>
<pre><code>## ------------------------------------------
## 
## term: (Intercept)
## 
## Response transformation matrix:
##                   (Intercept)
## negative.negative         0.5
## positive.negative         0.5
## negative.positive         0.5
## positive.positive         0.5
## 
## multiv. tests:
##       Df test stat approx F num Df den Df Pr(&gt;F)
## Wald   1   0.85307  0.85307      1     25 0.3645
## Wilks  1   0.96595  0.88125      1     25 0.3568
## 
## univ. test:
##        Sum Sq num Df Error SS den Df F value Pr(&gt;F)
## F-test 0.7295      1   20.695     25  0.8812 0.3568
## 
## ------------------------------------------
## 
## term: Peer
## 
## Response transformation matrix:
##                   Peer1
## negative.negative  -0.5
## positive.negative   0.5
## negative.positive  -0.5
## positive.positive   0.5
## 
## multiv. tests:
##       Df test stat approx F num Df den Df Pr(&gt;F)
## Wald   1   0.18200  0.18200      1     25 0.6733
## Wilks  1   0.99124  0.22083      1     25 0.6425
## 
## univ. test:
##          Sum Sq num Df Error SS den Df F value Pr(&gt;F)
## F-test 0.045471      1   5.1477     25  0.2208 0.6425
## 
## ------------------------------------------
## 
## term: Human
## 
## Response transformation matrix:
##                   Human1
## negative.negative   -0.5
## positive.negative   -0.5
## negative.positive    0.5
## positive.positive    0.5
## 
## multiv. tests:
##       Df test stat approx F num Df den Df    Pr(&gt;F)    
## Wald   1   22.6149   22.615      1     25 7.021e-05 ***
## Wilks  1    0.5058   24.431      1     25 4.322e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## univ. test:
##        Sum Sq num Df Error SS den Df F value    Pr(&gt;F)    
## F-test 13.782      1   14.102     25  24.431 4.322e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## ------------------------------------------
## 
## term: Peer:Human
## 
## Response transformation matrix:
##                   Peer1:Human1
## negative.negative          0.5
## positive.negative         -0.5
## negative.positive         -0.5
## positive.positive          0.5
## 
## multiv. tests:
##       Df test stat approx F num Df den Df Pr(&gt;F)
## Wald   1   0.06643 0.066430      1     25 0.7987
## Wilks  1   0.99670 0.082832      1     25 0.7759
## 
## univ. test:
##          Sum Sq num Df Error SS den Df F value Pr(&gt;F)
## F-test 0.015346      1   4.6316     25  0.0828 0.7759
## 
## ------------------------------------------</code></pre>
<p>The output is very similar to the output produced by the <code>car</code> package. The contrast matrix (or response transformation matrix) as well as test statistics for each of the effects are printed. Univariate and multivariate statistics are given. As latent RM-ANOVA relys on structural equation modeling, maximum likelihood is used for estimating the model parameters. The Wald test is a common test for testing parameters in the structural equation modeling framework. Wilk’s lambda is based on the means and variances of the effect variables (i.e., contrasts). That is, Wilk’s lambda is not based on an OLS estimator, but on the maximum likelihood estimates. This is also valid for the univariate test statistics.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="example.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="traditional-anova.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["semnova-man.pdf", "semnova-man.epub"],
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

</body>

</html>
