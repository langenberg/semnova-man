[["index.html", "semnova: An R package for latent repeated measures ANOVA Preface About semnova Citing semnova Changelog", " semnova: An R package for latent repeated measures ANOVA Benedikt Langenberg and Axel Mayer 2021-01-02 Preface About semnova semnova is an R package for analyzing data from repeated measures experimental designs. semnova implements latent repeated measures analysis of variance (RM-ANOVA) which is a structural equation modeling based alternative to tradtional RM-ANOVA. Traditional RM-ANOVA is a widely used statistical tool in the field of psychology and social sciences. RM-ANOVA can analyze data such as test scores, questionnaire items, reaction times, attitudes, characteristics, or motives. Oftentimes, the construct of interest cannot be observed directly and the aforementioned measures contain measurement errors. Latent RM-ANOVA can include multiple indicators that measure the same latent construct of and prune of measurement error. Latent RM-ANOVA can furthermore be used to examine interindividual differences in main and interaction effects of experimental factors and introduces a whole lot of other advantages from the structural equation modeling framework. This very short tutorial is mainly based on the article by Langenberg et al. (2020). This tutorial, however, only covers how to use semnova for latent RM-ANOVA. If you would like to know more about the methods behind the software, check out the article. Citing semnova Please use this reference to cite the software package: Langenberg, B., Helm, J. L., &amp; Mayer, A. (2020). Repeated measures ANOVA with latent variables to analyze interindividual differences in contrasts. Multivariate Behavioral Research, 1–19. https://doi.org/10.1080/00273171.2020.1803038 Changelog 2019-06-13: First Commit "],["installation.html", "1 Installation 1.1 Installation via devtools (recommended) 1.2 Installation via cran", " 1 Installation semnova is available on cran. It is, however, recommended to install the latest version from github via the devtools package. In the installation process, a couple of other packages will be installed. In particular, semnova strongly depends on the structural equation modeling software lavaan (Rosseel, 2012). 1.1 Installation via devtools (recommended) Make sure to install devtools first. Just copy and run the following lines within R. if (!require(&quot;devtools&quot;, character.only = T)) { install.packages(&quot;devtools&quot;) } devtools::install_github(&quot;langenberg/semnova&quot;) 1.2 Installation via cran Simply run this code to install semnova via cran. install.packages(&quot;semnova&quot;) "],["example.html", "2 Example 2.1 Getting the Data 2.2 Introducing the Data 2.3 Preparing the Data", " 2 Example semnova is a package intended for latent RM-ANOVA. In the following, we will download a publicly available dataset by Qu et al. (2015) and perform latent RM-ANOVA on a subset of the data. 2.1 Getting the Data The data set can be downloaded from the PLoS ONE website. We use the openxlsx package for importing the data and the tidyverse collection (Wickham et al., 2019) for further data manipulations. if (!require(&quot;openxlsx&quot;, character.only = T)) { install.packages(&quot;openxlsx&quot;) library(openxlsx) } if (!require(&quot;tidyverse&quot;, character.only = T)) { install.packages(&quot;tidyverse&quot;) library(tidyverse) } d_raw &lt;- read.xlsx(&quot;https://doi.org/10.1371/journal.pone.0125279.s001&quot;) %&gt;% as_tibble() 2.2 Introducing the Data Let’s briefly introduce the study conducted by Qu et al. (2015). The authors investigated a bystander effect in a virtual classroom setting. In particular, participants first witnessed virtual students answering questions from a teacher in a training for spoken English. The participants afterwards answered questions themselves. During both parts of the experiment, virtual students (bystanders) whispered and commented on the virtual speaker and the human speaker, respectively. The whispering was either positive or negative. This resulted in a two by two within subject repeated measures design. Every participant received every condition. The relevant sub scale used in our analysis is the virtual students’ performance. We only use two items from this sub scale measuring attitudes towards the virtual bystanders and the performance of the virtual bystanders on an 11-point scale reaching from 0 (very bad) to 11 (very good). A graphical illustration of these items can be found in Figure 2.1 Figure 2.1: Means and standard errors for the the investigated items across the four experimental conditions. 2.3 Preparing the Data The dataset contains a lot of variables. In the next step, we select only the relevant variables. d_wide &lt;- d_raw %&gt;% select(ID, S1PP:S2NN) d_wide ## # A tibble: 26 x 9 ## ID S1PP S1NP S1PN S1NN S2PP S2NP S2PN S2NN ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 1 0.913 0.177 -0.927 -0.927 0.913 0.177 -0.927 -0.927 ## 2 2 0.752 1.56 0.128 -1.81 0.565 0.939 -0.246 -2.12 ## 3 3 0.238 0.238 -1.32 0.0275 0.660 0.238 -1.49 -0.689 ## 4 4 -1.54 1.47 1.09 1.60 -0.552 1.09 0.655 1.52 ## 5 5 -0.269 0.120 -0.269 0.120 -0.269 0.120 -0.269 0.509 ## 6 6 0.463 0.0686 0.108 0.858 0.463 0.858 0.463 0.0686 ## 7 7 1.10 0.707 -0.701 -1.49 0.663 0.179 -0.657 -0.657 ## 8 8 0.200 0.777 0.392 0.585 -0.665 0.873 -0.665 1.07 ## 9 9 1.88 0.356 0.297 0.297 1.47 1.17 -0.287 -0.521 ## 10 10 0.600 1.44 0.676 0.216 0.753 0.753 0.830 -0.168 ## # … with 16 more rows "],["latent-repeated-measures-anova.html", "3 Latent Repeated Measures ANOVA 3.1 Arguments 3.2 The first analysis", " 3 Latent Repeated Measures ANOVA 3.1 Arguments The input for semnova is very similar to the car package for analysis of variance (Fox &amp; Weisberg, 2019). It takes the following arguments: formula: A formula object. idesign: A design object describing the factorial design. idata: A table mapping the dependent variables to the experimental conditions. data: A dataset. mmodel (optional): A measurement model mapping the variables from the dataset to the variables in the formula object. If not given, the variables from the formula object will be used. formula The formula object contains the names of the dependent variables (i.e., the combinations of the levels of the factors). formula &lt;- cbind(NN, PN, NP, PP) ~ 1 NN, for instance, represents the condition Peer = negative and Human = negative. idata The idata object is a dataframe that has as many rows as variables in the formula object. The columns represent the experimental factors. The rows represent the possible combinations of the factor levels. idata &lt;- expand.grid(Peer = c(&quot;negative&quot;, &quot;positive&quot;), Human = c(&quot;negative&quot;, &quot;positive&quot;)) idata ## Peer Human ## 1 negative negative ## 2 positive negative ## 3 negative positive ## 4 positive positive The idata object maps the combinations of the factorial levels to the variables in the formula object. idesign The design object is a formula object that represents the effects of interest. That is, when expanded, the formula contains the terms (i.e., the main and interaction effects) that the user is interested in. Currently, semnova can only model saturated models, that is, all possible terms are inlcuded. Subsets are currently not possible, but will this feature will be added in the future. idesign &lt;- ~Peer*Human mmodel The measurement model is optional. If the dependent variables are measure via multiple indicators, the create_mmodel() can be used to map variables from the dataset to the variables from the formula object. By default, the effects-coding indentification method introduced by Little et al. (2006) is used. If you prefer the referent-indicator method, add the argument lv_scaling = &quot;referent. library(semnova) mmodel &lt;- create_mmodel( NN = c(&quot;S1NN&quot;, &quot;S2NN&quot;), PN = c(&quot;S1PN&quot;, &quot;S2PN&quot;), NP = c(&quot;S1NP&quot;, &quot;S2NP&quot;), PP = c(&quot;S1PP&quot;, &quot;S2PP&quot;) ) 3.2 The first analysis The function semnova() performs the analysis and takes the aforementioned arguments: library(semnova) fit &lt;- semnova( formula = cbind(NN, PN, NP, PP) ~ 1, data = d_wide, idata = idata, idesign = idesign, mmodel = mmodel ) Hypothesis tests of default main and interaction effects can be printed using the summary() function: summary(fit) ## ------------------------------------------ ## ## term: (Intercept) ## ## Response transformation matrix: ## (Intercept) ## negative.negative 0.5 ## positive.negative 0.5 ## negative.positive 0.5 ## positive.positive 0.5 ## ## multiv. tests: ## Df test stat approx F num Df den Df Pr(&gt;F) ## Wald 1 0.85307 0.85307 1 25 0.3645 ## Wilks 1 0.96595 0.88125 1 25 0.3568 ## ## univ. test: ## Sum Sq num Df Error SS den Df F value Pr(&gt;F) ## F-test 0.7295 1 20.695 25 0.8812 0.3568 ## ## ------------------------------------------ ## ## term: Peer ## ## Response transformation matrix: ## Peer1 ## negative.negative -0.5 ## positive.negative 0.5 ## negative.positive -0.5 ## positive.positive 0.5 ## ## multiv. tests: ## Df test stat approx F num Df den Df Pr(&gt;F) ## Wald 1 0.18200 0.18200 1 25 0.6733 ## Wilks 1 0.99124 0.22083 1 25 0.6425 ## ## univ. test: ## Sum Sq num Df Error SS den Df F value Pr(&gt;F) ## F-test 0.045471 1 5.1477 25 0.2208 0.6425 ## ## ------------------------------------------ ## ## term: Human ## ## Response transformation matrix: ## Human1 ## negative.negative -0.5 ## positive.negative -0.5 ## negative.positive 0.5 ## positive.positive 0.5 ## ## multiv. tests: ## Df test stat approx F num Df den Df Pr(&gt;F) ## Wald 1 22.6149 22.615 1 25 7.021e-05 *** ## Wilks 1 0.5058 24.431 1 25 4.322e-05 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## univ. test: ## Sum Sq num Df Error SS den Df F value Pr(&gt;F) ## F-test 13.782 1 14.102 25 24.431 4.322e-05 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## ------------------------------------------ ## ## term: Peer:Human ## ## Response transformation matrix: ## Peer1:Human1 ## negative.negative 0.5 ## positive.negative -0.5 ## negative.positive -0.5 ## positive.positive 0.5 ## ## multiv. tests: ## Df test stat approx F num Df den Df Pr(&gt;F) ## Wald 1 0.06643 0.066430 1 25 0.7987 ## Wilks 1 0.99670 0.082832 1 25 0.7759 ## ## univ. test: ## Sum Sq num Df Error SS den Df F value Pr(&gt;F) ## F-test 0.015346 1 4.6316 25 0.0828 0.7759 ## ## ------------------------------------------ The output is very similar to the output produced by the car package. The contrast matrix (or response transformation matrix) as well as test statistics for each of the effects are printed. Univariate and multivariate statistics are given. As latent RM-ANOVA relys on structural equation modeling, maximum likelihood is used for estimating the model parameters. The Wald test is a common test for testing parameters in the structural equation modeling framework. Wilk’s lambda is based on the means and variances of the effect variables (i.e., contrasts). That is, Wilk’s lambda is not based on an OLS estimator, but on the maximum likelihood estimates. This is also valid for the univariate test statistics. "],["traditional-anova.html", "4 Traditional ANOVA", " 4 Traditional ANOVA In this section, traditional RM-ANOVA is performed for a brief comparison with latent RM-ANOVA. For this analysis, the two indicators are averaged for each subject within each of the experimental conditions as RM-ANOVA can only deal with manifest variables. The car package is used for this analysis. First of all, a new dataset is needed containing the averaged indicators. This is being done using the tidyverse collection. In the next chunk, the long format dataset is only an auxiliary dataset as averaging more convenient with long data. if (!require(&quot;car&quot;, character.only = T)) { install.packages(&quot;car&quot;) } library(car) library(tidyverse) d_long &lt;- d_wide %&gt;% gather(condition, value, -ID) %&gt;% mutate(item = substr(condition, 1, 2), condition = substr(condition, 3, 4)) d_mean_wide &lt;- d_long %&gt;% group_by(ID, condition) %&gt;% summarise(value = mean(value)) %&gt;% spread(condition, value) d_mean_wide ## # A tibble: 26 x 5 ## # Groups: ID [26] ## ID NN NP PN PP ## &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 1 -0.927 0.177 -0.927 0.913 ## 2 2 -1.96 1.25 -0.0588 0.659 ## 3 3 -0.331 0.238 -1.40 0.449 ## 4 4 1.56 1.28 0.870 -1.05 ## 5 5 0.314 0.120 -0.269 -0.269 ## 6 6 0.463 0.463 0.286 0.463 ## 7 7 -1.07 0.443 -0.679 0.883 ## 8 8 0.825 0.825 -0.136 -0.232 ## 9 9 -0.112 0.765 0.00506 1.67 ## 10 10 0.0236 1.10 0.753 0.676 ## # … with 16 more rows The idata and the idesign objects are just the same as for latent RM-ANOVA. idata ## Peer Human ## 1 negative negative ## 2 positive negative ## 3 negative positive ## 4 positive positive idesign ## ~Peer * Human Now, let’s run the analysis using the Anova function. Note that the variables in the formula now are actual variables from the dataset (average scores). anova_model &lt;- lm(cbind(NN, PN, NP, PP) ~ 1, d_mean_wide) anova_fit &lt;- Anova(anova_model, idata = idata, idesign = idesign, type = &quot;III&quot;) summary(anova_fit) ## ## Type III Repeated Measures MANOVA Tests: ## ## ------------------------------------------ ## ## Term: (Intercept) ## ## Response transformation matrix: ## (Intercept) ## NN 1 ## PN 1 ## NP 1 ## PP 1 ## ## Sum of squares and products for the hypothesis: ## (Intercept) ## (Intercept) 2.234811 ## ## Multivariate Tests: (Intercept) ## Df test stat approx F num Df den Df Pr(&gt;F) ## Pillai 1 0.0233974 0.5989488 1 25 0.44624 ## Wilks 1 0.9766026 0.5989488 1 25 0.44624 ## Hotelling-Lawley 1 0.0239580 0.5989488 1 25 0.44624 ## Roy 1 0.0239580 0.5989488 1 25 0.44624 ## ## ------------------------------------------ ## ## Term: Peer ## ## Response transformation matrix: ## Peer1 ## NN 1 ## PN -1 ## NP 1 ## PP -1 ## ## Sum of squares and products for the hypothesis: ## Peer1 ## Peer1 0.1304386 ## ## Multivariate Tests: Peer ## Df test stat approx F num Df den Df Pr(&gt;F) ## Pillai 1 0.0047895 0.1203125 1 25 0.7316 ## Wilks 1 0.9952105 0.1203125 1 25 0.7316 ## Hotelling-Lawley 1 0.0048125 0.1203125 1 25 0.7316 ## Roy 1 0.0048125 0.1203125 1 25 0.7316 ## ## ------------------------------------------ ## ## Term: Human ## ## Response transformation matrix: ## Human1 ## NN 1 ## PN 1 ## NP -1 ## PP -1 ## ## Sum of squares and products for the hypothesis: ## Human1 ## Human1 50.63608 ## ## Multivariate Tests: Human ## Df test stat approx F num Df den Df Pr(&gt;F) ## Pillai 1 0.4442502 19.98427 1 25 0.00014706 *** ## Wilks 1 0.5557498 19.98427 1 25 0.00014706 *** ## Hotelling-Lawley 1 0.7993709 19.98427 1 25 0.00014706 *** ## Roy 1 0.7993709 19.98427 1 25 0.00014706 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## ------------------------------------------ ## ## Term: Peer:Human ## ## Response transformation matrix: ## Peer1:Human1 ## NN 1 ## PN -1 ## NP -1 ## PP 1 ## ## Sum of squares and products for the hypothesis: ## Peer1:Human1 ## Peer1:Human1 0.02058027 ## ## Multivariate Tests: Peer:Human ## Df test stat approx F num Df den Df Pr(&gt;F) ## Pillai 1 0.0009096 0.02276124 1 25 0.88129 ## Wilks 1 0.9990904 0.02276124 1 25 0.88129 ## Hotelling-Lawley 1 0.0009104 0.02276124 1 25 0.88129 ## Roy 1 0.0009104 0.02276124 1 25 0.88129 ## ## Univariate Type III Repeated-Measures ANOVA Assuming Sphericity ## ## Sum Sq num Df Error SS den Df F value Pr(&gt;F) ## (Intercept) 0.5587 1 23.3201 25 0.5989 0.4462367 ## Peer 0.0326 1 6.7760 25 0.1203 0.7315986 ## Human 12.6590 1 15.8362 25 19.9843 0.0001471 *** ## Peer:Human 0.0051 1 5.6511 25 0.0228 0.8812904 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 "],["under-construction-fit-measures.html", "5 [under construction] Fit Measures", " 5 [under construction] Fit Measures "],["under-construction-interindividual-differences.html", "6 [under construction] Interindividual Differences", " 6 [under construction] Interindividual Differences "],["under-construction-custom-contrasts.html", "7 [under construction] Custom Contrasts", " 7 [under construction] Custom Contrasts "],["under-construction-between-subject-factors.html", "8 [under construction] Between-Subject Factors", " 8 [under construction] Between-Subject Factors "],["under-construction-covariance-structures.html", "9 [under construction] Covariance Structures", " 9 [under construction] Covariance Structures "],["under-construction-visualization.html", "10 [under construction] Visualization", " 10 [under construction] Visualization "],["outlook.html", "11 Outlook 11.1 Roadmap", " 11 Outlook 11.1 Roadmap enhanced output effect sizes variance estimates of the effect variables between subject designs stochastic group sizes plots covariates Bayesian estimation "],["references.html", "References", " References "]]
